<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>삼각 달팽이 시각화</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Outfit:wght@300;500;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --primary: #38bdf8;
            --secondary: #818cf8;
            --accent: #f472b6;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --success: #22c55e;
            --cell-bg: #334155;
            --cell-active: #38bdf8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            overflow-x: hidden;
        }

        h1 {
            font-family: 'Outfit', sans-serif;
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            letter-spacing: -0.05em;
        }

        .subtitle {
            color: var(--text-muted);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            width: 100%;
            max-width: 1200px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        label {
            font-weight: 600;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        input[type="number"] {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            color: white;
            font-size: 1.1rem;
            outline: none;
            transition: border-color 0.2s;
        }

        input[type="number"]:focus {
            border-color: var(--primary);
        }

        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        button {
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        button:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            grid-column: span 2;
        }

        .btn-outline {
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .visualization-area {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
            border-radius: 2rem;
            overflow: hidden;
            min-height: 550px;
            border: 1px solid rgba(255, 255, 255, 0.03);
        }

        .triangle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 2rem;
        }

        .row {
            display: flex;
            gap: 8px;
        }

        .cell {
            width: 45px;
            height: 45px;
            background-color: var(--cell-bg);
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Outfit', sans-serif;
            font-weight: 700;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            opacity: 0.3;
            transform: scale(0.8);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .cell.filled {
            opacity: 1;
            transform: scale(1);
            background: rgba(255, 255, 255, 0.1);
        }

        .cell.current {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.6);
            transform: scale(1.1);
            color: white;
            z-index: 10;
        }

        .status-dashboard {
            margin-top: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .status-label {
            color: var(--text-muted);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-value {
            font-weight: 700;
            color: var(--primary);
        }

        .dir-indicator {
            padding: 4px 12px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            font-size: 0.8rem;
            font-weight: 600;
        }

        .dir-down {
            background: rgba(56, 189, 248, 0.2);
            color: #38bdf8;
        }

        .dir-right {
            background: rgba(129, 140, 248, 0.2);
            color: #818cf8;
        }

        .dir-up {
            background: rgba(244, 114, 182, 0.2);
            color: #f472b6;
        }

        .full-width-container {
            width: 100%;
            max-width: 1200px;
            margin-top: 2rem;
        }

        .flatten-array {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            background: rgba(0, 0, 0, 0.2);
            padding: 1.5rem;
            border-radius: 1rem;
            min-height: 80px;
            align-content: flex-start;
        }

        .array-item {
            background: var(--cell-bg);
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            animation: fadeIn 0.3s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 1rem;
        }

        input[type="range"] {
            flex: 1;
            accent-color: var(--primary);
        }

        @media (max-width: 1000px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .visualization-area {
                min-height: 400px;
            }
        }
    </style>
</head>

<body>

    <h1>Triangular Snail</h1>
    <p class="subtitle">반시계 방향으로 소용돌이치는 삼각형 배열 채우기</p>

    <div class="main-container">
        <div class="visualization-area">
            <div id="triangle-container" class="triangle-container"></div>
        </div>

        <div class="card">
            <div class="controls">
                <div class="input-group">
                    <label for="n-input">삼각형 크기 (n)</label>
                    <input type="number" id="n-input" value="5" min="2" max="15">
                </div>

                <div class="btn-grid">
                    <button id="start-btn" class="btn-primary">시뮬레이션 시작</button>
                    <button id="step-btn" class="btn-outline">다음 단계</button>
                    <button id="reset-btn" class="btn-outline">초기화</button>
                    <button id="auto-btn" class="btn-outline" style="grid-column: span 2;">자동 재생</button>
                </div>

                <div class="speed-control">
                    <label>속도</label>
                    <input type="range" id="speed-range" min="100" max="1000" value="500" step="100">
                </div>

                <div class="status-dashboard">
                    <div class="status-item">
                        <span class="status-label">현재 값 (num)</span>
                        <span id="stat-num" class="status-value">1</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">방향 패턴</span>
                        <span id="stat-dir" class="dir-indicator dir-down">아래 (Down)</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">현재 인덱스 (x, y)</span>
                        <span id="stat-pos" class="status-value">(0, 0)</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">진행률</span>
                        <span id="stat-progress" class="status-value">0%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="full-width-container">
        <h3 style="margin-bottom: 1rem; color: var(--text-muted); font-size: 0.9rem; text-transform: uppercase;">
            Flattened Result</h3>
        <div id="flatten-array" class="flatten-array"></div>
    </div>

    <div class="full-width-container"
        style="margin-top: 4rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 2rem; margin-bottom: 4rem;">
        <h2 style="font-family: 'Outfit'; margin-bottom: 1.5rem; color: var(--primary);">How it Works</h2>
        <div style="color: var(--text-muted); line-height: 1.8; font-size: 0.95rem;">
            <p style="margin-bottom: 1rem;">삼각 달팽이 알고리즘은 <strong>아래 -> 오른쪽 -> 대각선 위</strong> 순서로 방향을 틀며 숫자를 채워나가는
                시뮬레이션입니다.</p>
            <ul style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                <li><strong>방향 전환 (n번)</strong>: 총 n번의 방향 전환이 일어납니다.</li>
                <li><strong>이동 거리 감소</strong>: 각 방향으로 이동할 때마다 채워야 할 칸의 개수가 n, n-1, n-2 ... 1개 순으로 줄어듭니다.</li>
                <li><strong>좌표 변화</strong>:
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>아래: <code>x + 1</code></li>
                        <li>오른쪽: <code>y + 1</code></li>
                        <li>대각선 위: <code>x - 1, y - 1</code></li>
                    </ul>
                </li>
            </ul>
            <p>모든 칸을 채운 후, 2차원 배열의 첫 번째 행부터 마지막 행까지 순서대로 1차원 리스트에 담으면 최종 결과가 완성됩니다.</p>
        </div>
    </div>

    <script>
        const triangleContainer = document.getElementById('triangle-container');
        const flattenArray = document.getElementById('flatten-array');
        const nInput = document.getElementById('n-input');
        const startBtn = document.getElementById('start-btn');
        const stepBtn = document.getElementById('step-btn');
        const resetBtn = document.getElementById('reset-btn');
        const autoBtn = document.getElementById('auto-btn');
        const speedRange = document.getElementById('speed-range');

        const statNum = document.getElementById('stat-num');
        const statDir = document.getElementById('stat-dir');
        const statPos = document.getElementById('stat-pos');
        const statProgress = document.getElementById('stat-progress');

        let n = 5;
        let state = {
            i: 0, j: 0, x: -1, y: 0, num: 1, totalNum: 0,
            isFinished: false, isPlaying: false, timer: null
        };

        function reset() {
            n = parseInt(nInput.value) || 5;
            n = Math.min(Math.max(n, 2), 15);
            nInput.value = n;
            triangleContainer.innerHTML = '';
            flattenArray.innerHTML = '';
            for (let r = 0; r < n; r++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'row';
                for (let c = 0; c <= r; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.id = `cell-${r}-${c}`;
                    cell.textContent = '0';
                    rowDiv.appendChild(cell);
                }
                triangleContainer.appendChild(rowDiv);
            }
            state = {
                i: 0, j: 0, x: -1, y: 0, num: 1,
                totalNum: (n * (n + 1)) / 2,
                isFinished: false, isPlaying: false, timer: null
            };
            updateStats();
            clearInterval(state.timer);
            autoBtn.textContent = '자동 재생';
            autoBtn.disabled = false;
            startBtn.disabled = false;
        }

        function updateStats() {
            statNum.textContent = state.num - 1 || 1;
            statPos.textContent = `(${Math.max(0, state.x)}, ${state.y})`;
            const progress = Math.round(((state.num - 1) / state.totalNum) * 100);
            statProgress.textContent = `${progress}%`;
            const dirType = state.i % 3;
            if (dirType === 0) { statDir.textContent = '아래 (Down)'; statDir.className = 'dir-indicator dir-down'; }
            else if (dirType === 1) { statDir.textContent = '오른쪽 (Right)'; statDir.className = 'dir-indicator dir-right'; }
            else { statDir.textContent = '대각선 위 (Up-Left)'; statDir.className = 'dir-indicator dir-up'; }
        }

        function step() {
            if (state.isFinished) return;
            if (state.j >= n - state.i) {
                state.i++; state.j = 0;
                if (state.i >= n) { finish(); return; }
            }
            const dirType = state.i % 3;
            if (dirType === 0) state.x++;
            else if (dirType === 1) state.y++;
            else { state.x--; state.y--; }

            const cell = document.getElementById(`cell-${state.x}-${state.y}`);
            if (cell) {
                document.querySelectorAll('.cell.current').forEach(el => el.classList.remove('current'));
                cell.textContent = state.num;
                cell.classList.add('filled', 'current');
                const item = document.createElement('div');
                item.className = 'array-item';
                item.textContent = state.num;
                flattenArray.appendChild(item);
            }
            state.num++; state.j++;
            updateStats();
            if (state.num > state.totalNum) finish();
        }

        function finish() {
            state.isFinished = true; state.isPlaying = false;
            clearInterval(state.timer);
            autoBtn.textContent = '완료'; autoBtn.disabled = true;
            document.querySelectorAll('.cell.current').forEach(el => el.classList.remove('current'));
            rebuildFinalResult();
        }

        function rebuildFinalResult() {
            flattenArray.innerHTML = '';
            for (let r = 0; r < n; r++) {
                for (let c = 0; c <= r; c++) {
                    const cell = document.getElementById(`cell-${r}-${c}`);
                    const item = document.createElement('div');
                    item.className = 'array-item';
                    item.textContent = cell.textContent;
                    flattenArray.appendChild(item);
                }
            }
        }

        function toggleAuto() {
            if (state.isFinished) return;
            if (state.isPlaying) {
                state.isPlaying = false; clearInterval(state.timer);
                autoBtn.textContent = '자동 재생';
            } else {
                state.isPlaying = true; autoBtn.textContent = '일시 정지';
                const speed = 1100 - parseInt(speedRange.value);
                state.timer = setInterval(step, speed);
            }
        }

        startBtn.addEventListener('click', () => { reset(); step(); });
        stepBtn.addEventListener('click', step);
        resetBtn.addEventListener('click', reset);
        autoBtn.addEventListener('click', toggleAuto);
        speedRange.addEventListener('input', () => {
            if (state.isPlaying) {
                clearInterval(state.timer);
                const speed = 1100 - parseInt(speedRange.value);
                state.timer = setInterval(step, speed);
            }
        });
        reset();
    </script>
</body>

</html>